{% load static %}
<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
    <head>
        <meta charset="UTF-8">
        <title>
            {% block title %}StudyDeck Forum{% endblock %}
        </title>
        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
              rel="stylesheet">
        <link rel="stylesheet"
              href="https://unpkg.com/easymde/dist/easymde.min.css">
        <link rel="stylesheet" href="{% static "forum/css/easyMDEBeautify.css" %}">
        <link rel="stylesheet"
              href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
        <style>
        label.btn:has(input[type="checkbox"]:checked) {
            background-color: var(--bs-primary);
            color: white;
            border-color: var(--bs-primary);
        }

        :target {
            outline: 2px solid var(--bs-primary);
            outline-offset: 4px;
        }

        blockquote {
        position: relative;
        border-left: 4px solid #4f8cff;
        background: rgba(79, 140, 255, 0.08);
        padding: 12px 16px 12px 40px;
        margin: 14px 0;
        border-radius: 6px;

        color: #cfd8ff;
        font-style: italic;
        line-height: 1.6;
        }

        blockquote::before {
        content: "â€œ";
        position: absolute;
        left: 12px;
        top: 4px;
        font-size: 32px;
        color: #4f8cff;
        opacity: 0.7;
        }

        /* Inline code */
code {
  background: #2d2d2d;
  color: #ffcc99;
  padding: 2px 6px;
  border-radius: 4px;
  font-family: "Fira Code", monospace;
  font-size: 0.95em;
}

/* Code blocks */
pre {
  background: #1e1e1e;
  color: #d4d4d4;
  padding: 14px 16px;
  border-radius: 8px;
  overflow-x: auto;
  margin: 12px 0;
  border: 1px solid #333;
  font-family: "Fira Code", monospace;
  font-size: 14px;
  line-height: 1.6;
}

/* Code inside pre */
pre code {
  background: none;
  padding: 0;
  color: inherit;
}



        </style>
    </head>
    <!-- IMPORTANT: padding-top compensates for fixed navbar -->
    <body class="bg-body text-body" style="padding-top: 70px;">
        <nav class="navbar navbar-expand-lg fixed-top border-bottom border-secondary"
             style="background-color: #0f172a">
            <div class="container-fluid px-4 position-relative">
                <!-- LEFT: Logo + Brand -->
                <a class="navbar-brand d-flex align-items-center gap-2 fw-semibold text-white"
                   href="/">
                    <img src="{% static 'forum/logo.png' %}" alt="StudyDeck Logo" height="34">
                    <span class="fs-5">StudyDeck Forum</span>
                </a>
                {% if user.is_authenticated %}
                    <!-- CENTER: Search -->
                    <form class="d-none d-md-flex position-absolute start-50 translate-middle-x"
                          method="get"
                          action="#"
                          style="width: 420px">
                        <input class="form-control form-control-sm me-2"
                               type="search"
                               name="q"
                               placeholder="Search using title..."
                               aria-label="Search">
                        <button class="btn btn-sm btn-outline-secondary" type="submit">Search</button>
                    </form>
                {% endif %}
                <!-- RIGHT: Actions + User info -->
                <div class="d-flex align-items-center gap-3 ms-auto">
                    {% if user.is_authenticated %}
                        <!-- MODERATOR: Reports -->
                        {% if perms.forum.view_report_page %}
                            <a href="{% url 'reports-list' %}"
                               class="btn btn-sm btn-outline-warning fw-semibold">ðŸš© Reports</a>
                        {% endif %}
                        <a href="{% url 'category-list' %}"
                           class="btn btn-sm btn-outline-light fw-semibold">Categories</a>
                        <a href="{% url 'create-thread' %}"
                           class="btn btn-sm btn-primary fw-semibold">Create Thread</a>
                        <!-- USER DROPDOWN -->
                        <div class="dropdown">
                            <a href="#"
                               class="d-flex align-items-center text-decoration-none dropdown-toggle"
                               data-bs-toggle="dropdown"
                               aria-expanded="false">
                                {% if user.socialaccount_set.first.extra_data.picture %}
                                    <img src="{{ user.socialaccount_set.first.extra_data.picture }}"
                                         class="rounded-circle border border-secondary"
                                         width="38"
                                         height="38"
                                         referrerpolicy="no-referrer"
                                         alt="Profile">
                                {% else %}
                                    <img src="{% static 'forum/default_user.jpg' %}"
                                         class="rounded-circle border border-secondary"
                                         width="38"
                                         height="38"
                                         alt="Profile">
                                {% endif %}
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end shadow">
                                <li class="px-3 py-2">
                                    <div class="fw-semibold">{{ user.socialaccount_set.first.extra_data.name|default:user }}</div>
                                    <div class="text-muted small">{{ user.email }}</div>
                                </li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li>
                                    <form method="post" action="{% url 'account_logout' %}">
                                        {% csrf_token %}
                                        <button type="submit" class="dropdown-item text-danger">Logout</button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </div>
        </nav>
        <!-- Messages -->
        {% if messages %}
            <div class="container mt-3">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm rounded"
                         role="alert">
                        {{ message }}
                        <button type="button"
                                class="btn-close"
                                data-bs-dismiss="alert"
                                aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        <!-- Page Content -->
        <div class="container">
            {% block content %}{% endblock %}
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>
  document.addEventListener("DOMContentLoaded", function () {
    hljs.highlightAll();
  });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
                crossorigin="anonymous"></script>
    </body>
</html>
